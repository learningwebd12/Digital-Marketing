<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="/stylesheet/admin.css">
</head>
<body>

<div class="grid">
    <aside>
        <button class="main-admin-btn one-btn">Add About</button>
        <button class="main-admin-btn two-btn">Add Team</button>
        <button class="main-admin-btn third-btn">Add Services</button>
        <button class="main-admin-btn fourth-btn">Contact Us</button>
    </aside>

    <div class="main-admin">
        <h1>Admin Dashboard</h1>
        <!-- About Us Form -->
        <section class="about-dashboard">
            <h2>About Us</h2>
            <form action="/adminDashboard/about" method="POST">
                <label for="title">Title:</label>
                <input type="text" id="title" name="title" required><br><br>

                <label for="description">Description:</label>
                <textarea id="description" name="description" required></textarea><br><br>

                <button type="submit">Save</button>
            </form>
        </section>

        <!-- Add Team Member Form -->
        <section class="add-team">
            <h2>Add Team Member</h2>
            <form action="/adminDashboard/team" method="POST" enctype="multipart/form-data">
                <label for="name">Name:</label>
                <input type="text" id="name" name="name" required><br><br>

                <label for="position">Position:</label>
                <input type="text" id="position" name="position" required><br><br>

                <label for="profilePic">Profile Picture:</label>
                <input type="file" id="profilePic" name="profilePic" accept="image/*" required><br><br>

                <label for="linkedin">LinkedIn URL:</label>
                <input type="text" id="linkedin" name="linkedin"><br><br>

                <label for="instagram">Instagram URL:</label>
                <input type="text" id="instagram" name="instagram"><br><br>

                <button type="submit">Add Team Member</button>
            </form>
        </section>

        <!-- Add Services Form -->
        <section>
            <h3>Add Services</h3>
            <form action="/adminDashboard/services" method="POST">
                <label for="sname"></label>
                <input type="text" name="name" placeholder="Services Name">
                <input type="text" name="description" placeholder="Describe about services">
                <button type="submit">Add Services</button>
            </form>
        </section>

        <!-- Contact Messages Section -->
       <section class="all-contact-message">
        <table>
          <thead>
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Message</th>
            </tr>
          </thead>
          <tbody>
            <% if (contacts && contacts.length > 0) { %>
              <% contacts.forEach(contact => { %>
                <tr>
                  <td class="all-message-details"><%= contact.name %></td>
                  <td class="all-message-details"><%= contact.email %></td>
                  <td class="all-message-details"><%= contact.message %></td>
                  <td>
                    <button type="button" onclick="deleteContact('<%= contact._id %>')">Delete</button>
                  </td>
                </tr>
              <% }); %>
            <% } else { %>
              <tr>
                <td colspan="4">No contact messages found.</td>
              </tr>
            <% } %>
          </tbody>
        </table>

       </section>

       <section>
        <h1>All Team Members</h1>
        <div class="all">
          <% allList.forEach(function(data) { %>
            <div class="team-member" style="border: 1px solid red; display: flex; justify-content: start; align-items: center;">
              <p>Name: <%= data.name %></p>
              <p>Position: <%= data.position %></p>
              <p>Profile Picture: <img style="height: 5vw;" src="<%= data.profilePic %>" alt="<%= data.name %>'s profile picture" /></p>
              <p>LinkedIn: <a href="<%= data.linkedin %>"><%= data.linkedin %></a></p>
              <p>Instagram: <a href="<%= data.instagram %>"><%= data.instagram %></a></p>
              <a href="/edit/<%= data._id %>" class="edit-button">Edit</a>
              <button onclick="deleteTeamMember('<%= data._id %>')">Delete</button>
            </div>
          <% }); %>
        </div>
      </section>
      
          

    </div>
</div>
<script>
async function deleteContact(id) {
  const response = await fetch(`/contact/${id}`, {
    method: 'DELETE',
  });

  if (response.ok) {
    location.reload(); 
  } else {
    alert("Error deleting contact");
  }
}


//delete team member

async function deleteTeamMember(id){
  const response= await fetch(`/team/${id}`,{
    method:'DELETE',
  });

  if(response.ok){
    location.reload();
  }
  else{
    alert("error deleting team member");
  }
}




    let btn = document.getElementsByClassName("one-btn")[0];
    let twoBtn = document.getElementsByClassName("two-btn")[0];

    let showNext = document.getElementsByClassName("add-team")[0];
    let show = document.getElementsByClassName("about-dashboard")[0];

    btn.addEventListener("click", function() {
        show.style.display = "block";
    });
    twoBtn.addEventListener("click", function() {
        showNext.style.display = "block";
    });
</script>
</body>
</html>
